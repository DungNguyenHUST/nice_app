<div class='post_index_block'>
    <div class='post_index_info'>
        <%owner_user = find_owner_user(@post.user_id)%>
        <div class='post_index_info_left'>
            <div class="post_index_user_avatar checked_<%=find_user_color(owner_user.name)%>">
                <a><%= link_to owner_user.name[0], user_session_path(owner_user), class: "post_index_user_name_label"%></a>
            </div>
        </div>
        <div class='post_index_info_right'>
            <div class="post_index_user_name">
                <a><%=owner_user.name%></a>
            </div>
            <div class="post_index_create">
                <span><%=time_ago_in_words(@post.created_at)%></span>
            </div>
        </div>
    </div>
    <div class='post_index_title'>
        <a><%= link_to (@post.title), post_path(@post) %></a>
    </div>
    <div class='post_index_content'>
        <a><%=@post.content%></a>
    </div>

    <div class="post_index_toolbar_block">
        <div class="post_index_vote_unvote_block">
            <div class="post_index_vote_block" id="post_index_vote_<%=@post.id%>">
                <%if current_user.present?%>
                    <% pre_vote = @post.post_votes.find { |vote| vote.user_id == current_user.id} %>
                <%end%>
                <% if pre_vote %>  
                    <%= button_to post_post_vote_path(@post, pre_vote), method: :delete, remote: true do%>
                        <i><%= bootstrap_icon "caret-up-fill", width: 28, height: 28, fill: "#1877f2" %></i>
                    <%end%> 
                <%else%>
                    <%= button_to post_post_votes_path(@post), method: :post, remote: true do%>
                        <i><%= bootstrap_icon "caret-up", width: 28, height: 28, fill: "#888" %></i>
                    <%end%> 
                <%end%>
            </div>

            <div class="post_index_vote_unvote_count">
                <span><%=@post.post_votes.count - @post.post_unvotes.count%></span>
            </div>

            <div class="post_index_unvote_block" id="post_index_unvote_<%=@post.id%>">
                <%if current_user.present?%>
                    <% pre_unvote = @post.post_unvotes.find { |unvote| unvote.user_id == current_user.id} %>
                <%end%>
                <% if pre_unvote %>  
                    <%= button_to post_post_unvote_path(@post, pre_unvote), method: :delete, remote: true do%>
                        <i><%= bootstrap_icon "caret-down-fill", width: 28, height: 28, fill: "#1877f2" %></i>
                    <%end%> 
                <%else%>
                    <%= button_to post_post_unvotes_path(@post), method: :post, remote: true do%>
                        <i><%= bootstrap_icon "caret-down", width: 28, height: 28, fill: "#888" %></i>
                    <%end%> 
                <%end%>
            </div>
        </div>

        <div class="post_index_comment_block">
            <%= button_to post_path(@post), method: :get, form_class: "post_index_comment" do%>
                <i><%= bootstrap_icon "chat-square", width: 18, height: 18, fill: "#666" %></i>
                <a><%= @post.post_comments.count%><span>Comments</span></a> 
            <%end%> 
        </div>

        <div class="post_index_save_block">
        </div>

        <div class="post_index_share_block">
            <%= button_to post_path(@post), method: :get, form_class: "post_index_share" do%>
                <i><%= bootstrap_icon "arrow-repeat", width: 22, height: 22, fill: "#666" %></i>
                <a><%= @post.post_comments.count%><span>Share</span></a> 
            <%end%> 
        </div>
    </div>

</div>